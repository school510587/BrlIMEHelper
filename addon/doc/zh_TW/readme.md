# Braille IME Helper
1.0 版

## 簡介
點字輸入法助手 (BrlIMEHelper) 讓使用者可以直接用點字顯示器上的點字鍵盤輸入國字。當沒有點字鍵盤可用，本附加元件也可以把電腦鍵盤模擬成點字鍵盤。有了本附加元件將點字輸入轉換成輸入法的操作，熟練點字規則的使用者不必學習其他輸入法或者鍵盤排列方式也能打出國字。目前，本附加元件的實作基於台灣廣泛使用的[注音點字](http://class.kh.edu.tw/19061/bulletin/msg_view/75)與微軟注音輸入法，不過未來本附加元件的概念也可以延伸到別的點字系統與輸入法。

## 功能
1. 用點字鍵盤輸入中文（與標點符號、數學符號等）。
2. 把電腦鍵盤模擬成點字鍵盤。
3. 能同時使用系統或 NVDA 組合鍵。
4. 不同視窗可以使用不同輸入狀態。
5. 支援瀏覽器密碼輸入。

## 系統環境需求
安裝之前，請使用者先確認這些環境設定：（譯註：由於台灣本土化團隊在 2018 年間曾調整許多翻譯用語，以下內容將以最新版 NVDA 為準。）

- NVDA 2017.3 或以上之版本。
- 「微軟注音」必須為您的預設輸入法，且具有下列之設定：
    * 組字狀態預設為英數模式。
    * 使用標準注音鍵盤排列方式。（預設值）
    * 左邊 Shift 鍵的功能設為切換組字模式。（預設值）
- 如果您想要用電腦鍵盤來模擬點字鍵盤，必須先確認它支援 NKRO (N-key rollover)。（譯註：許多遊戲的操作也需要此特性來配合，因此選擇鍵盤時請留意它是否能用來「打遊戲」。）參見： [What PC keyboards allow for 6-key braille data entry?](https://www.duxburysystems.com/faq2.asp?faq=32&fbclid=IwAR0zdRHClvT5gikN_RqAEX_phxEp51HZX9dtDGUkWU5gTprmvBUPyBs5cFk)
- 請避免同時執行「點字輸入法助手」與其他關於點字輸入的程式或附加元件，如 [PC Keyboard Braille Input for NVDA](https://addons.nvda-project.org/addons/pcKeyboardBrailleInput.en.html) 附加元件及[點字酷音](https://github.com/EasyIME/PIME "PIME 輸入法")輸入法等。
- 建議停用 NVDA 設定中「輸入法組字」的「讀出輸入的組字字元」，以享受迅速流暢的打字體驗。
- 建議將「輸入轉譯表」設為「英文（美國）八點（電腦）」，使 NVDA 行為比較符合台灣使用者的操作習慣。

## 操作方式
- 快速鍵
    * 點字鍵盤
        + 點字 4 5 6 點 + 點字空白：在中文輸入及英數輸入之間切換，效果與按下電腦鍵盤 Shift 相同。
        + 點字第 1 點 + 點字空白：查看點字緩衝區，也就是中文模式下尚未完成組字的點字內容。（例：只有打 135 126 點還不構成字，但是此功能會提示您已經輸入了ㄅㄛ。）
        + 點字 2 4 5 點 + 點字空白：當點字輸入到一半發現打錯了，此熱鍵能直接清除點字緩衝區，讓您重新輸入正確內容。
        + 點字 1 2 3 點 + 點字空白：單獨切換電腦鍵盤之英數輸入模式（譯註：可讓電腦鍵盤輸入中文時模擬點字鍵盤，英數輸入時獨立切換點字或一般鍵盤模式）。
    * 電腦鍵盤
        + NvDA+X: 啟用／停用電腦鍵盤模擬點字鍵盤功能。
        + F, D, S, J, K, L, A, 分號鍵：點字 1 到 8 點。
        + 0 到 9: 保留給輸入數字與指定候選字。
- 備註
    1. 在英數輸入模式中，點字輸入效果由 NVDA 輸入轉譯表決定。
    2. 點字鍵盤單獨按第 7 或第 8 點，或者 7 8 點一起按下，無論中文、英數輸入都保留 NVDA 的原始預設行為。
    3. 本附加元鑑不會影響點顯器的其他功能按鈕，如點字視窗前後捲動與游標定位鍵。
    4. 使用者可以在 NVDA 的「輸入手勢」對話框中管理上列所有快速鍵。
    5. 若組字完成，沒有報讀組成的國字或者符號，可能輸入了不合理的注音導致輸入法卡住（譯註：可用 BackSpace 或者 Esc 鍵清除錯誤的注音符號，但是使用 Esc 時須注意，若多按一次可能造成浮動組字區的其他內容被一併清除）。

## 問題與改進方向
- 目前已知的程式錯誤：
    * 當啟用「持續顯示訊息」，認何點字訊息不會隨著輸入法文字改變而消失。
- 未來可能的改進：
    * 允許使用者自訂本附加元見的預設狀態。
    * 允許使用者自訂點字鍵在電腦鍵盤上模擬的位置。
    * 允許使用者自訂符號的點字輸入方式，或者由點字轉譯表載入。
    * 讓本附加元件能與其他注音輸入法配合。
    * 讓本附加元件能與其他注音鍵盤排列方式配合。

## 貢獻者
- Bo-Cheng Jhan <school510587@yahoo.com.tw>
- 黃偉豪 <hurt.nzsmr@gmail.com>

## 致謝
- 「點字輸入法助手」於 2019/07/01 至 2019/12/31 受到[社團法人臺灣視障協會](https://www.facebook.com/tavip1030102/) <vipastaiwan@gmail.com> 支持開發，特此深表感謝。

## 修改歷程

### 0.0 版
* 初始版本。

### 0.1 版
* 重構說明文件，讓使用者更易於閱讀。
* 當前景視窗改變時，清除點字緩衝區內容。

### 0.2 版
* 修正瀏覽資料夾過程中第七點 (A) 模擬的行為錯誤。
* 將 __init__.py 分開為二個檔案。

### 0.3 版
* 使輸出訊息可以翻譯成不同語言。
* 實作新的點字解析方式。
* 加入 "addon_lastTestedNVDAVersion" 資訊。
* 加入打出單獨一個注音符號的規則。
* 修正幾個數學符號的輸入點位。

### 0.4 版
* 用延遲寄送輸入的方式實現點位前綴的相容性。
* 當這次點字輸入被拒絕時，嘗試替換掉最近一方的點字輸入。
* 將 ∠ 的點位改成 ⠫⠪ (1246-246) 也就是 ← 點位的前綴。

### 0.5 版
* 重構程式碼。
* 瀏覽模式中停止用電腦鍵盤模擬點字鍵盤。
* 給予每個功能適當的文件說明與分類。

### 0.6 版
* 實現僅在輸入法英數模式中開關點字輸入的模擬與否。
* 使用 str 型別來處理 bopomofo.json 的路徑。
* 當載入點字輸入法助手的電腦鍵盤處理程序時，若有修飾鍵仍被壓下，不進行點字輸入的模擬。

### 0.7 版
* 替某些符號加入不同的點字輸入方式。
* 讓點字熱鍵可從 NVDA 輸入手勢視窗來管理。
* 調整指令的程式碼中某些書寫習慣。

### 1.0 版
* 支援基於 Python 3 的 NVDA 2019.3 版。
* 實作使用者設定的對話視窗。
